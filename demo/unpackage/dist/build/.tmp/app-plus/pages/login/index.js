(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/login/index"],{"0071":function(e,t,n){},"0119":function(e,t,n){"use strict";n.r(t);var r=n("a6bb"),a=n("e0ac");for(var i in a)"default"!==i&&function(e){n.d(t,e,function(){return a[e]})}(i);n("f867");var d=n("2877"),o=Object(d["a"])(a["default"],r["a"],r["b"],!1,null,null,null);t["default"]=o.exports},"284d":function(e,t,n){"use strict";(function(e,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n("2f62"),i=n("355e"),d=n("9122");function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){s(e,t,n[t])})}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u={computed:o({},(0,a.mapState)(["code"])),mounted:function(){e.setNavigationBarTitle({title:"健康生活"})},onLoad:function(){},data:function(){return{showDialog:!1,currentUser:{},encrypt:null,first:!1}},methods:o({},(0,a.mapMutations)(["setCode","setCurrentUser","setAddress"]),{addAddress:function(e){this.$store.commit("setAddress",e)},OnWechatAuthorized:function(){e.navigateTo({url:"login"})},getPhoneNumber:function(t){var n=this;console.log(r(t," at pages\\login\\index.vue:50")),this.encrypt=t.detail,t.detail&&t.detail.errMsg&&"getPhoneNumber:ok"!=t.detail.errMsg?e.showModal({title:"授权失败",content:t.detail.errMsg,showCancel:!1}):(0,i.getUserInfoWechat)().then(function(t){return e.showLoading({}),n.currentUser=t.userInfo,n.$store.commit("setCurrentUser",n.currentUser),(0,i.loginWechat)()}).then(function(e){return(0,i.getOpenId)(e)}).then(function(e){if(e.data.data.unionid)return n.currentUser.OpenId=e.data.data.unionid,n.currentUser.sessionKey=e.data.data.sessionKey,n.$store.commit("setCurrentUser",n.currentUser),(0,i.decodeUserInfo)(n.encrypt.encryptedData,n.encrypt.iv,n.currentUser.OpenId)}).then(function(t){if(t.data.data&&t.data.data.phoneNumber)return n.currentUser.phone=t.data.data.phoneNumber,n.$store.commit("setCurrentUser",n.currentUser),(0,i.getUser)(n.currentUser.OpenId);e.hideLoading(),e.showModal({title:"授权失败",content:"获取电话失败",showCancel:!1})}).then(function(t){t&&(n.first=null==t.data.data.avatarUrl&&null==t.data.data.nickName,n.currentUser=o({},t.data.data,n.currentUser),console.log(r(JSON.stringify(n.currentUser)," at pages\\login\\index.vue:94")),n.$store.commit("setCurrentUser",n.currentUser),n.first,(0,i.updateUser)({avatarUrl:n.currentUser.avatarUrl,nickName:n.currentUser.nickName,phone:n.currentUser.phone,unionId:n.currentUser.OpenId}).then(function(e){if(e)return(0,d.listFamilys)(n.currentUser.OpenId)}).then(function(t){e.hideLoading(),t.data.data&&0==t.data.data.length?e.navigateTo({url:"../address/addAddress"}):(n.addAddress(t.data.data),e.switchTab({url:"../index/index"}))}))}).catch(function(t){e.hideLoading(),"getUserInfo:fail scope unauthorized"==t.errMsg&&(n.showDialog=!0)})},phone_login:function(){e.navigateTo({url:"./phoneLogin"})},onGetUserInfo:function(t){var n=this;t.detail&&t.detail.userInfo&&(this.currentUser=t.detail.userInfo,this.$store.commit("setCurrentUser",this.currentUser),e.showLoading({}),(0,i.loginWechat)().then(function(e){return(0,i.getOpenId)(e)}).then(function(e){if(e.data.data.unionid)return n.currentUser.OpenId=e.data.data.unionid,n.$store.commit("setCurrentUser",n.currentUser),(0,i.getUser)(n.currentUser.OpenId)}).then(function(t){if(t){if(n.first=null==t.data.data.avatarUrl&&null==t.data.data.nickName,n.currentUser=o({},t.data.data,n.currentUser),console.log(r(JSON.stringify(n.currentUser)," at pages\\login\\index.vue:184")),n.$store.commit("setCurrentUser",n.currentUser),!n.first)return(0,d.listFamilys)(n.currentUser.OpenId);(0,i.updateUser)({avatarUrl:n.currentUser.avatarUrl,nickName:n.currentUser.nickName,phone:null,unionId:n.currentUser.OpenId}).then(function(e){if(e)return(0,d.listFamilys)(n.currentUser.OpenId)}).then(function(t){e.hideLoading(),t.data.data&&0==t.data.data.length?e.navigateTo({url:"../address/addAddress"}):(n.addAddress(t.data.data),e.switchTab({url:"../index/index"}))})}}).then(function(t){e.hideLoading(),t.data.data&&0==t.data.data.length?e.navigateTo({url:"../address/addAddress"}):(n.addAddress(t.data.data),e.switchTab({url:"../index/index"}))}).catch(function(t){e.hideLoading()}))}})};t.default=u}).call(this,n("6e42")["default"],n("0de9")["default"])},5082:function(e,t,n){"use strict";(function(e){n("b52e"),n("921b");r(n("66fd"));var t=r(n("0119"));function r(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},a6bb:function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement;e._self._c},a=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a})},e0ac:function(e,t,n){"use strict";n.r(t);var r=n("284d"),a=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t["default"]=a.a},f867:function(e,t,n){"use strict";var r=n("0071"),a=n.n(r);a.a}},[["5082","common/runtime","common/vendor"]]]);